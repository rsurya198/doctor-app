<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Doctor Portal â€” Access</title>
  <style>
    * {margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
    body {background:linear-gradient(135deg,#1a73e8,#0d47a1);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;}
    .container {background:#fff;border-radius:20px;box-shadow:0 15px 35px rgba(0,0,0,0.2);width:100%;max-width:520px;padding:40px 30px;}
    h1 {color:#0d47a1;text-align:center;margin-bottom:15px;}
    p {text-align:center;color:#666;margin-bottom:25px;}
    .form-group {margin-bottom:18px;}
    label {display:block;margin-bottom:6px;color:#333;font-weight:500;}
    .form-control,.form-select {
      width:100%;padding:12px 15px;border:1px solid #ddd;border-radius:8px;font-size:15px;transition:.3s;
    }
    .form-control:focus,.form-select:focus {border-color:#1a73e8;outline:none;box-shadow:0 0 0 3px rgba(26,115,232,0.2);}
    .btn {display:block;width:100%;padding:14px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:.3s;}
    .btn-primary {background:linear-gradient(135deg,#1a73e8,#0d47a1);color:white;margin-top:10px;}
    .btn-primary:hover {transform:translateY(-2px);box-shadow:0 5px 15px rgba(26,115,232,.4);}
    .toggle-link {text-align:center;margin-top:15px;cursor:pointer;color:#1a73e8;}
    .error-message,.success-message {display:none;padding:12px;border-radius:6px;margin-top:15px;font-size:14px;}
    .error-message {color:#d32f2f;background:#ffebee;}
    .success-message {color:#2e7d32;background:#e8f5e9;}
  </style>
</head>
<body>
  <div class="container">
    <h1>Doctor Portal</h1>
    <p id="formTitle">Login to continue</p>

    <!-- LOGIN FORM -->
    <form id="loginForm">
      <div class="form-group">
        <label for="loginUsername">Username</label>
        <input type="text" id="loginUsername" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="loginPassword">Password</label>
        <input type="password" id="loginPassword" class="form-control" required/>
      </div>
      <button type="submit" class="btn btn-primary">Login</button>
      <div id="loginError" class="error-message"></div>
    </form>

    <!-- REGISTER FORM -->
    <form id="registerForm" style="display:none;" enctype="multipart/form-data">
      <div class="form-group">
        <label for="fullName">Full Name</label>
        <input type="text" id="fullName" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="phone">Phone Number</label>
        <input type="tel" id="phone" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="registerUsername">Username</label>
        <input type="text" id="registerUsername" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="registerPassword">Password</label>
        <input type="password" id="registerPassword" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <input type="password" id="confirmPassword" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="specialization">Specialization</label>
        <input type="text" id="specialization" class="form-control" placeholder="e.g. Cardiology, Dermatology" required/>
      </div>
      <div class="form-group">
        <label for="experience">Years of Experience</label>
        <input type="number" id="experience" class="form-control" min="0" required/>
      </div>
      <div class="form-group">
        <label for="licenseNumber">Medical License Number</label>
        <input type="text" id="licenseNumber" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="clinicName">Hospital / Clinic Name</label>
        <input type="text" id="clinicName" class="form-control" required/>
      </div>
      <div class="form-group">
        <label for="documents">Upload Medical License / ID Proof</label>
        <input type="file" id="documents" class="form-control" accept=".pdf,.jpg,.jpeg,.png" />
      </div>
      <button type="submit" class="btn btn-primary">Register</button>
      <div id="registerError" class="error-message"></div>
      <div id="registerSuccess" class="success-message"></div>
    </form>

    <div class="toggle-link" id="toggleForm">Don't have an account? Register</div>
  </div>

  <script>
    const loginForm = document.getElementById("loginForm");
    const registerForm = document.getElementById("registerForm");
    const toggleForm = document.getElementById("toggleForm");
    const formTitle = document.getElementById("formTitle");

    toggleForm.addEventListener("click", () => {
      if (loginForm.style.display !== "none") {
        loginForm.style.display = "none";
        registerForm.style.display = "block";
        formTitle.innerText = "Register as Doctor";
        toggleForm.innerText = "Already have an account? Login";
      } else {
        registerForm.style.display = "none";
        loginForm.style.display = "block";
        formTitle.innerText = "Login to continue";
        toggleForm.innerText = "Don't have an account? Register";
      }
    });

    // LOGIN SUBMIT
    loginForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const username = document.getElementById("loginUsername").value;
      const password = document.getElementById("loginPassword").value;
      const loginError = document.getElementById("loginError");

      try {
        const res = await fetch("/api/auth/login", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({ username, password })
        });
        const data = await res.json();
        if (!res.ok) throw new Error(data.message || "Login failed");
        localStorage.setItem("token", data.token);
        window.location.href = "/Home.html"; // redirect to portal
      } catch (err) {
        loginError.innerText = err.message;
        loginError.style.display = "block";
      }
    });

    // REGISTER SUBMIT
    registerForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const fullName = document.getElementById("fullName").value;
      const email = document.getElementById("email").value;
      const phone = document.getElementById("phone").value;
      const username = document.getElementById("registerUsername").value;
      const password = document.getElementById("registerPassword").value;
      const confirmPassword = document.getElementById("confirmPassword").value;
      const specialization = document.getElementById("specialization").value;
      const experience = document.getElementById("experience").value;
      const licenseNumber = document.getElementById("licenseNumber").value;
      const clinicName = document.getElementById("clinicName").value;
      const documents = document.getElementById("documents").files[0];

      const registerError = document.getElementById("registerError");
      const registerSuccess = document.getElementById("registerSuccess");

      if (password !== confirmPassword) {
        registerError.innerText = "Passwords do not match";
        registerError.style.display = "block";
        return;
      }

      const formData = new FormData();
      formData.append("fullName", fullName);
      formData.append("email", email);
      formData.append("phone", phone);
      formData.append("username", username);
      formData.append("password", password);
      formData.append("specialization", specialization);
      formData.append("experience", experience);
      formData.append("licenseNumber", licenseNumber);
      formData.append("clinicName", clinicName);
      formData.append("documents", documents);

      try {
        const res = await fetch("/api/auth/register", {
          method: "POST",
          body: formData
        });
        const data = await res.json();
        if (!res.ok) throw new Error(data.message || "Registration failed");

        registerError.style.display = "none";
        registerSuccess.innerText = "Registration successful! Please login.";
        registerSuccess.style.display = "block";
      } catch (err) {
        registerError.innerText = err.message;
        registerError.style.display = "block";
      }
    });
  </script>
</body>
</html>
